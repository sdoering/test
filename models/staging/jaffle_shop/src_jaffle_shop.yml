version: 2
sources:
  - name: jaffle_shop
    database: raw
    schema: jaffle_shop
    tables:
        - name: customers
          columns:
            - name: id
              tests:
                - unique 
                - not_null 
        - name: orders
          loaded_at_field: _etl_loaded_at
          freshness: 
            warn_after:
              count: 12
              period: hour
            error_after:
              count: 24
              period: hour
          columns:
            - name: id
              tests:
                - unique
                - not_null 
          description: >
            One record per order. Includes cancelled and deleted orders.
            - name: status
              description: The status of the order. Will change over time.
              tests:
                - acceptesd_values
                  values:
                    - completed
                    - shipped
                    - returned
                    - placed
                    - return_pending
            - name: customer_id
              tests:
                - relationships:
                    to: ref('stg_customers')
                    field: customer_id